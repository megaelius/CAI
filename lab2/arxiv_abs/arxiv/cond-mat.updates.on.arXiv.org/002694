Intratumor heterogeneity (ITH), referring to coexistence of different cell subpopulations in
a single tumor, has been a major puzzle in cancer research for almost half a century. The lack of understanding
of the underlying mechanism of ITH hinders progress in developing effective therapies for cancers.
Based on the findings in a recent quantitative experiment on pancreatic cancer, we developed a general
evolutionary model for one type of cancer, accounting for interactions between different cell
populations through paracrine or juxtacrine factors. We show that the emergence of a stable heterogeneous
state in a tumor requires an unequal allocation of paracrine growth factors ("public goods") between
cells that produce them and those that merely consume them. Our model provides a quantitative explanation
of recent {\it in vitro} experimental studies in pancreatic cancer in which insulin growth factor
(IGF-II) plays the role of public goods. The calculated phase diagrams as a function of exogenous
resources and fraction of growth factor producing cells show ITH persists only in a narrow range
of concentration of exogenous IGF-II. Remarkably, maintenance of ITH requires cooperation among
tumor cell subpopulations in harsh conditions, specified by lack of exogenous IGF-II, whereas
surplus exogenous IGF-II elicits competition. Our theory also quantitatively accounts for measured
{\it in vivo} tumor growth in glioblastoma multiforme (GBM). The predictions for GBM tumor growth
as a function of the fraction of tumor cells are amenable to experimental tests. The mechanism for
ITH also provides hints for devising efficacious therapies. 