We present an extension of the tunneling theory for scanning tunneling microcopy (STM) to include
different types of vibrational-electronic couplings responsible for inelastic contributions
to the tunnel current in the strong-coupling limit. It allows for a better understanding of more
complex scanning tunneling spectra of molecules on a metallic substrate in separating elastic
and inelastic contributions. The starting point is the exact solution of the spectral functions
for the electronic active local orbitals in the absence of the STM tip. This includes electron-phonon
coupling in the coupled system comprising the molecule and the substrate to arbitrary order including
the anti-adiabatic strong coupling regime as well as the Kondo effect on a free electron spin of the
molecule. The tunneling current is derived in second order of the tunneling matrix element which
is expanded in powers of the relevant vibrational displacements. We use the results of an ab-initio
calculation for the single-particle electronic properties as an adapted material-specific input
for a numerical renormalization group approach for accurately determining the electronic properties
of a NTCDA molecule on Ag(111) as a challenging sample system for our theory. Our analysis shows that
the mismatch between the ab-initio many-body calculation of the tunnel current in the absence of
any electron-phonon coupling to the experiment scanning tunneling spectra can be resolved by including
two mechanisms: (i) a strong unconventional Holstein term on the local substrate orbital leads
to reduction of the Kondo temperature and (ii) a different electron-vibrational coupling to the
tunneling matrix element is responsible for inelastic steps in the $dI/dV$ curve at finite frequencies.
