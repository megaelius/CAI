The growing interest in using x-ray spectroscopy for refined materials characterization calls
for accurate electronic-structure theory to interpret x-ray near-edge fine structure. In this
work, we propose an efficient and unified framework to describe all the many-electron processes
in a Fermi liquid after a sudden perturbation (such as a core hole). This problem has been visited
by the Mahan-Nozi\'eres-De Dominicis (MND) theory, but it is intractable to implement various
Feynman diagrams within first-principles calculations. Here, we adopt a non-diagrammatic approach
and treat all the many-electron processes in the MND theory on an equal footing. Starting from a recently
introduced determinant formalism [Phys. Rev. Lett. 118, 096402 (2017)], we exploit the linear-dependence
of determinants describing different final states involved in the spectral calculations. An elementary
graph algorithm, breadth-first search, can be used to quickly identify the important determinants
for shaping the spectrum, which avoids the need to evaluate a great number of vanishingly small terms.
This search algorithm is performed over the tree-structure of the many-body expansion, which mimics
a path-finding process. We demonstrate that the determinantal approach is computationally inexpensive
even for obtaining x-ray spectra of extended systems. Using Kohn-Sham orbitals from two self-consistent
fields (ground and core-excited state) as input for constructing the determinants, the calculated
x-ray spectra for a number of transition metal oxides are in good agreement with experiments. Many-electron
aspects beyond the Bethe-Salpeter equation, as captured by this approach, are also discussed,
such as shakeup excitations and many-body wave function overlap considered in Anderson's orthogonality
catastrophe. 