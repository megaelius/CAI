The Bohr-Sommerfeld quantization rule lies at the heart of the modern semiclassical theory of a
Bloch electron in a magnetic field. This rule is predictive of Landau levels and de-Haas-van-Alphen
oscillations for conventional metals, as well as for a host of topological metals which have emerged
in the recent intercourse between band theory, crystalline symmetries and topology. The essential
ingredients in any quantization rule are connection formulae that match the semiclassical (WKB)
wavefunction across regions of strong quantum fluctuations. Here, we propose (a) a multi-component
WKB wavefunction that describes transport within degenerate-band subspaces, and (b) the requisite
connection formulae for saddlepoints and type-II Dirac points, where tunneling respectively
occurs within the same band, and between distinct bands. (a-b) extend previous works by incorporating
phase corrections that are subleading in powers of the field; these corrections include the geometric
Berry phase, and account for the orbital magnetic moment and the Zeeman coupling. A comprehensive
symmetry analysis is performed for such phase corrections occurring in closed orbits, which is
applicable to solids in any (magnetic) space group. We have further formulated a graph-theoretic
description of semiclassical orbits. This allows us to systematize the construction of quantization
rules for a large class of closed orbits (with or without tunneling), as well as to formulate the notion
of a topological invariant in semiclassical magnetotransport -- as a quantity that is invariant
under continuous deformations of the graph. Landau levels in the presence of tunneling are generically
quasirandom, i.e., disordered on the scale of nearest-neighbor level spacings but having longer-ranged
correlations; we develop a perturbative theory to determine Landau levels in such quasirandom
spectra. 