Energy storage units (ESUs) including EVs and home batteries enable several attractive features
of the modern smart grids such as effective demand response and reduced electric bills. However,
uncoordinated charging of ESUs stresses the power system. In this paper, we propose privacy-preserving
and collusion-resistant charging coordination centralized and decentralized schemes for the
smart grid. The centralized scheme is used in case of robust communication infrastructure that
connects the ESUs to the utility, while the decentralized scheme is useful in case of infrastructure
not available or costly. In the centralized scheme, each energy storage unit should acquire anonymous
tokens from a charging controller (CC) to send multiple charging requests to the CC via the aggregator.
CC can use the charging requests to enough data to run the charging coordination scheme, but it cannot
link the data to particular ESUs or reveal any private information. Our centralized scheme uses
a modified knapsack problem formulation technique to maximize the amount of power delivered to
the ESUs before the charging requests expire without exceeding the available maximum charging
capacity. In the decentralized scheme, several ESUs run the scheme in a distributed way with no need
to aggregator or CC. One ESU is selected as a head node that should decrypt the ciphertext of the aggregated
messages of the ESUs' messages and broadcast it to the community while not revealing the ESUs' individual
charging demands. Then, ESUs can coordinate charging requests based on the aggregated charging
demand while not exceeding the maximum charging capacity. Extensive experiments and simulations
are conducted to demonstrate that our schemes are efficient and secure against various attacks,
and can preserve ESU owner's privacy. 