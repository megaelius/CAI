We study k nearest neighbor queries in the plane for general (convex, pairwise disjoint) sites of
constant description complexity (such as line segment, disks, quadrilaterals and so on) and with
respect to a general family of distance functions including the L_p-norms and constant-size convex
distance functions. We develop a data structure with O( n log log n ) space, O( log n + k ) query time,
and expected O(n polylog n) preprocessing time, removing a ( log^2 n log log n )-factor from the O(
n ( log^2 n ) ( log log n)^2 ) space of Bohler et al's recent SoCG'16 work. In addition, our dynamic version
(that allows insertions and deletions of sites) also improves the space of Kaplan et al.'s recent
SODA'17 work from O( n log^3 n ) to O( n log n ), and reduces a ( log^2 n )-factor from their deletion time.
We obtain these improvements based on linear-size shallow cuttings, which are a standard technique
to deal with the k nearest neighbor problem for point sites in the Euclidean metric. Kaplan et al.
has generalized shallow cuttings to general distance functions, but the size of their version has
an extra double logarithmic factor. We successfully design linear-size shallow cuttings for general
distance functions, indicating that for general distance functions it could still be possible
to achieve the same complexities as point sites in the Euclidean metric. Our breakthrough to achieve
the linear size is a new random sampling technique (for the configuration space) that employs relatively
many local conflicts to prevent relatively few global conflicts. We believe this new random sampling
technique has its own merit for further applications. 