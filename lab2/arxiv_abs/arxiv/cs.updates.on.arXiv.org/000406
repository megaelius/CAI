We consider a point-to-point multiple-input-single-output (MISO) system where a receiver harvests
energy from a wireless power transmitter to power itself for various applications. The transmitter
performs energy beamforming by using an instantaneous channel state information (CSI). The CSI
is estimated at the receiver by training via a preamble, and fed back to the transmitter. The channel
estimate is more accurate when longer preamble is used, but less time is left for wireless power transfer
before the channel changes. To maximize the harvested energy, in this paper, we address the key challenge
of balancing the time resource used for channel estimation and wireless power transfer (WPT), and
also investigate the allocation of energy resource used for wireless power transfer. First, we
consider the general scenario where the preamble length is allowed to vary dynamically. Taking
into account the effects of imperfect CSI, the optimal preamble length is obtained online by solving
a dynamic programming (DP) problem. The solution is shown to be a threshold-type policy that depends
only on the channel estimate power. Next, we consider the scenario in which the preamble length is
fixed. The optimal preamble length is optimized offline. Furthermore, we derive the optimal power
allocation schemes for both scenarios. For the scenario of dynamic-length preamble, the power
is allocated according to both the optimal preamble length and the channel estimate power; while
for the scenario of fixed-length preamble, the power is allocated according to only the channel
estimate power. The analysis results are validated by numerical simulations. Encouragingly,
with optimal power allocation, the harvested energy by using optimized fixed-length preamble
is almost the same as the harvested energy by employing dynamic-length preamble, hence allowing
a low-complexity WPT system to be implemented in practice. 