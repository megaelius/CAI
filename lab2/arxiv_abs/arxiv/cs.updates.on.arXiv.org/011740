In a smart home system, multiple users have access to multiple devices, typically through a dedicated
app installed on a mobile device. Traditional access control mechanisms consider one unique trusted
user that controls the access to the devices. However, multi-user multi-device smart home settings
pose fundamentally different challenges to traditional single-user systems. For instance, in
a multi-user environment, users have conflicting, complex, and dynamically changing demands
on multiple devices, which cannot be handled by traditional access control techniques. To address
these challenges, in this paper, we introduce Kratos, a novel multi-user and multi-device-aware
access control mechanism that allows smart home users to flexibly specify their access control
demands. Kratos has three main components: user interaction module, backend server, and policy
manager. Users can specify their desired access control settings using the interaction module
which are translated into access control policies in the backend server. The policy manager analyzes
these policies and initiates negotiation between users to resolve conflicting demands and generates
final policies. We implemented Kratos and evaluated its performance on real smart home deployments
featuring multi-user scenarios with a rich set of configurations (309 different policies including
213 demand conflicts and 24 restriction policies). These configurations included five different
threats associated with access control mechanisms. Our extensive evaluations show that Kratos
is very effective in resolving conflicting access control demands with minimal overhead. We also
performed two user studies with 72 smart home users, one to better understand user's needs in before
the design and the other to test the efficacy of Kratos. 