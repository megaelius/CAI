In medical image analysis, constructing an atlas, i.e. a mean representative of an ensemble of images,
is a critical task for practitioners to estimate variability of shapes inside a population, and
to characterise and understand how structural shape changes have an impact on health. This involves
identifying significant shape constituents of a set of images, a process called segmentation,
and mapping this group of images to an unknown mean image, a task called registration, making a statistical
analysis of the image population possible. To achieve this goal, we propose treating these operations
jointly to leverage their positive mutual influence, in a hyperelasticity setting, by viewing
the shapes to be matched as Ogden materials. The approach is complemented by novel hard constraints
on the $L^\infty$ norm of both the Jacobian and its inverse, ensuring that the deformation is a bi-Lipschitz
homeomorphism. Segmentation is based on the Potts model, which allows for a partition into more
than two regions, i.e. more than one shape. The connection to the registration problem is ensured
by the dissimilarity measure that aims to align the segmented shapes. A representation of the deformation
field in a linear space equipped with a scalar product is then computed in order to perform a geometry-driven
Principal Component Analysis (PCA) and to extract the main modes of variations inside the image
population. Theoretical results emphasizing the mathematical soundness of the model are provided,
among which existence of minimisers, analysis of a numerical method of resolution, asymptotic
results and a PCA analysis, as well as numerical simulations demonstrating the ability of the modeling
to produce an atlas exhibiting sharp edges, high contrast and a consistent shape. 