People have used cloud computing approach to store their data remotely. As auspicious as this approach
is, it brings forth many challenges: from data security to time latency issues with data computation
as well as delivery to end users. Fog computing has emerged as an extension for cloud computing to
bring data processing and storage close to end-users; however, it minimizes the time latency issue
but still suffers from data security challenges. For instance, when a fog node providing services
to end users is compromised, the users' data security can be violated. Thus, this paper proposes
a secure and fine-grained data access control scheme by integrating the CP-ABE algorithm and blockchain
concept to prevent fog nodes from violating end users' data security in a situation where a compromised
fog node is being ousted. We also classify the fog nodes into fog federations, based on their attributes
such as services and locations, to minimize the time latency and communication overhead between
fog nodes and cloud server. Further, the exploitation and integration of the blockchain concept
and the CP-ABE algorithm enables fog nodes in the same fog federation to perform the authorization
process in a distributed manner. In addition, to solve time latency and communication overhead
problems, we equip every fog node with an off-chain database to store most frequently accessed data
files for specific time, and with an on-chain access control policies table (On-chain Files Tracking
Table) which must be protected from being tampered by malicious (rogue) fog nodes. Therefore, blockchain
plays a vital role here as it is tamper-proof by nature. We demonstrate our scheme's efficiency and
feasibility by designing algorithms and conducting a security analysis. The provided analysis
shows that the proposed scheme is efficient and feasible in ousting malicious (rogue) fog nodes.
