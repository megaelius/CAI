In the era of Internet of Things (IoT), Malware has been proliferating exponentially over the past
decade. Traditional anti-virus software are ineffective against modern complex Malware. In order
to address this challenge, researchers have proposed Hardware-assisted Malware Detection (HMD)
using Hardware Performance Counters (HPCs). The HPCs are used to train a set of Machine learning
(ML) classifiers, which in turn, are used to distinguish benign programs from Malware. Recently,
adversarial attacks have been designed by introducing perturbations in the HPC traces using an
adversarial sample predictor to misclassify a program for specific HPCs. These attacks are designed
with the basic assumption that the attacker is aware of the HPCs being used to detect Malware. Since
modern processors consist of hundreds of HPCs, restricting to only a few of them for Malware detection
aids the attacker. In this paper, we propose a Moving target defense (MTD) for this adversarial attack
by designing multiple ML classifiers trained on different sets of HPCs. The MTD randomly selects
a classifier; thus, confusing the attacker about the HPCs or the number of classifiers applied.
We have developed an analytical model which proves that the probability of an attacker to guess the
perfect HPC-classifier combination for MTD is extremely low (in the range of $10^{-1864}$ for a
system with 20 HPCs). Our experimental results prove that the proposed defense is able to improve
the classification accuracy of HPC traces that have been modified through an adversarial sample
generator by up to 31.5%, for a near perfect (99.4%) restoration of the original accuracy. 