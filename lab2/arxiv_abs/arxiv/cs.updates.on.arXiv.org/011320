Causal knowledge is vital for effective reasoning in science and medicine. In medical diagnosis
for example, a doctor aims to explain a patient's symptoms by determining the diseases \emph{causing}
them. However, all previous approaches to Machine-Learning assisted diagnosis, including Deep
Learning and model-based Bayesian approaches, learn by association and do not distinguish correlation
from causation. Here, we propose a new diagnostic algorithm based on counterfactual inference
which captures the causal aspect of diagnosis overlooked by previous approaches. Using a statistical
disease model, which describes the relations between hundreds of diseases, symptoms and risk factors,
we compare our counterfactual algorithm to the standard Bayesian diagnostic algorithm, and test
these against a cohort of 44 doctors. We use 1671 clinical vignettes created by a separate panel of
doctors to benchmark performance. Each vignette provides a non-exhaustive list of symptoms and
medical history simulating a single presentation of a disease. The algorithms and doctors are tasked
with determining the underlying disease for each vignette from symptom and medical history information
alone. While the Bayesian algorithm achieves an accuracy comparable to the average doctor, placing
in the top 48\% of doctors in our cohort, our counterfactual algorithm places in the top 25\% of doctors,
achieving expert clinical accuracy. Our results demonstrate the advantage of counterfactual
over associative reasoning in a complex real-world task, and show that counterfactual reasoning
is a vital missing ingredient for applying machine learning to medical diagnosis. 