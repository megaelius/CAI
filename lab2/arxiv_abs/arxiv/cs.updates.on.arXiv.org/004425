Industrial Fog computing deploys various industrial services, such as automatic monitoring/control
and imminent failure detection, at the Fog Nodes (FNs) to improve the performance of industrial
systems. Much effort has been made in the literature on the design of fog network architecture and
computation offloading. This paper studies an equally important but much less investigated problem
of service hosting where FNs are adaptively configured to host services for Sensor Nodes (SNs),
thereby enabling corresponding tasks to be executed by the FNs. The problem of service hosting emerges
because of the limited computational and storage resources at FNs, which limit the number of different
types of services that can be hosted by an FN at the same time. Considering the variability of service
demand in both temporal and spatial dimensions, when, where, and which services to host have to be
judiciously decided to maximize the utility of the Fog computing network. Our proposed Fog configuration
strategies are tailored to battery-powered FNs. The limited battery capacity of FNs creates a long-term
energy budget constraint that significantly complicates the Fog configuration problem as it introduces
temporal coupling of decision making across the timeline. To address all these challenges, we propose
an online distributed algorithm, called Adaptive Fog Configuration (AFC), based on Lyapunov optimization
and parallel Gibbs sampling. AFC jointly optimizes service hosting and task admission decisions,
requiring only currently available system information while guaranteeing close-to-optimal
performance compared to an oracle algorithm with full future information. 