Consider a situation wherein a stream of individuals arrive sequentially - for example when they
get unemployed - to a social planner. Once each individual arrives, the planner needs to decide instantaneously
on an action or treatment assignment - for example offering job training - while taking into account
various institutional constraints such as limited budget and capacity. In this paper, we show how
one can use offline observational data to estimate an optimal policy rule that maximizes ex-ante
expected welfare in this dynamic context. Importantly, we are able to find the optimal policy within
a pre-specified class of policy rules. The policies may be restricted for computational, legal
or incentive compatibility reasons. For each policy, we show that a Partial Differential Equation
(PDE) characterizes the evolution of the value function under that policy. Using the data, one can
write down a sample version of the PDE that provides estimates of these value functions. We then propose
a modified Reinforcement Learning algorithm to solve for the policy rule that achieves the best
value in the pre-specified class. The algorithm is easily implementable and computationally efficient,
with speedups achieved through multiple reinforcement learning agents simultaneously learning
the problem in parallel processes. By exploiting the properties of the PDEs, we show that the average
social welfare attained by the estimated policy rule converges at a $n^{-1/2}$ rate to the maximum
attainable within the specified class of policy functions; this is the same rate as that obtained
in the static case. Finally we also allow for non-compliance using instrumental variables, and
show how one can accommodate compliance heterogeneity in a dynamic setting. 