Let $G$ be a graph embedded in a fixed surface $\Sigma$ of genus $g$ and let $L=(L(v):v\in V(G))$ be
a collection of lists such that either each list has size at least five, or each list has size at least
four and $G$ is triangle-free, or each list has size at least three and $G$ has no cycle of length four
or less. An $L$-coloring of $G$ is a mapping $\phi$ with domain $V(G)$ such that $\phi(v)\in L(v)$
for every $v\in V(G)$ and $\phi(v)\ne\phi(u)$ for every pair of adjacent vertices $u,v\in V(G)$.
We prove * if every non-null-homotopic cycle in $G$ has length $\Omega(\log g)$, then $G$ has an $L$-coloring,
* if $G$ does not have an $L$-coloring, but every proper subgraph does ("$L$-critical graph"), then
$|V(G)|=O(g)$, * if every non-null-homotopic cycle in $G$ has length $\Omega(g)$, and a set $X\subseteq
V(G)$ of vertices that are pairwise at distance $\Omega(1)$ is precolored from the corresponding
lists, then the precoloring extends to an $L$-coloring of $G$, * if every non-null-homotopic cycle
in $G$ has length $\Omega(g)$, and the graph $G$ is allowed to have crossings, but every two crossings
are at distance $\Omega(1)$, then $G$ has an $L$-coloring, and * if $G$ has at least one $L$-coloring,
then it has at least $2^{\Omega(|V(G)|)}$ distinct $L$-colorings. We show that the above assertions
are consequences of certain isoperimetric inequalities satisfied by $L$-critical graphs, and
we study the structure of families of embedded graphs that satisfy those inequalities. It follows
that the above assertions hold for other coloring problems, as long as the corresponding critical
graphs satisfy the same inequalities. 