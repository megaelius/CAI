Blockchain, the technology behind the popular Bitcoin, is considered a "security by design" system
as it is meant to create security among a group of distrustful parties yet without a central trusted
authority. The security of blockchain relies on the premise of honest-majority, namely, the blockchain
system is assumed to be secure as long as the majority of consensus voting power is honest. And in the
case of proof-of-work (PoW) blockchain, adversaries cannot control more than 50% of the network's
gross computing power. However, this 50% threshold is based on the analysis of computing power only,
with implicit and idealistic assumptions on the network and node behavior. Recent researches have
alluded that factors such as network connectivity, presence of blockchain forks, and mining strategy
could undermine the consensus security assured by the honest-majority, but neither concrete analysis
nor quantitative evaluation is provided. In this paper we fill the gap by proposing an analytical
model to assess the impact of network connectivity on the consensus security of PoW blockchain under
different adversary models. We apply our analytical model to two adversarial scenarios: 1) honest-but-potentially-colluding,
2) selfish mining. For each scenario, we quantify the communication capability of nodes involved
in a fork race and estimate the adversary's mining revenue and its impact on security properties
of the consensus protocol. Simulation results validated our analysis. Our modeling and analysis
provide a paradigm for assessing the security impact of various factors in a distributed consensus
system. 