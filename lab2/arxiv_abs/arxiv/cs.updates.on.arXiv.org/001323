In this paper, the problem of smart grid energy management under stochastic dynamics is investigated.
In the considered model, at the demand side, it is assumed that customers can act as prosumers who
own renewable energy sources and can both produce and consume energy. Due to the coupling between
the prosumers' decisions and the stochastic nature of renewable energy, the interaction among
prosumers is formulated as a stochastic game, in which each prosumer seeks to maximize its payoff,
in terms of revenues, by controlling its energy consumption and demand. In particular, the subjective
behavior of prosumers is explicitly reflected into their payoff functions using prospect theory,
a powerful framework that allows modeling real-life human choices. For this prospect-based stochastic
game, it is shown that there always exists a stationary Nash equilibrium where the prosumers' trading
policies in the equilibrium are independent of the time and their histories of the play. Moreover,
a novel distributed algorithm with no information sharing among prosumers is proposed and shown
to converge to an $\epsilon$-Nash equilibrium. On the other hand, at the supply side, the interaction
between the utility company and the prosumers is formulated as an online optimization problem in
which the utility company's goal is to learn its optimal energy allocation rules. For this case,
it is shown that such an optimization problem admits a no-regret algorithm meaning that regardless
of the actual outcome of the game among the prosumers, the utility company can follow a strategy that
mitigates its allocation costs as if it knew the entire demand market a priori. Simulation results
show the convergence of the proposed algorithms to their predicted outcomes and present new insights
resulting from prospect theory that contribute toward more efficient energy management in the
smart grids. 