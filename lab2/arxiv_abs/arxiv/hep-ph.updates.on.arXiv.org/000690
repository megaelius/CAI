We study the $B\to\pi K$ puzzle by calculating the three parton one loop corrections in the QCD factorization
(QCDF) approach. We employ a general parameterization model for the $B\to\pi K$ amplitudes to introduce
twelve independent parameters, the weak angle $\gamma$ and the other eleven hadronic parameters.
Eight unknown parameters, four scale variables, one weak angle, and three nonperturbative strong
phases, are determined by a least square fit to the eight measurements of four branching ratios and
four direct CP asymmetries. The fit shows that the model based on QCDF calculations can completely
accommodate the experimental data. The eleven hadronic parameters and the three nonperturbative
strong phases are found to be process-dependent. A large negative relative phase associated with
the internal up quark gluonic penguin diagram is observed. The weak angle $\gamma$ is found to be
$72.1\pm5.8$ degree, being consistent with the world averaged value, $72.1\pm5.8$ degree. Using
the fit data to the mixing induced asymmetry $S(\pi^{0}K_{S})=0.58\pm0.06$, the weak angle $\beta$
is determined to be $22.9\pm2.1$ degree, in agreement with the world averaged value, $22.5\pm4.4\pm0.6$
degree. The theoretical prediction for the ratio $C^{\prime}/T^{\prime}$ (color suppressed/color
favored) is found to be $0.58\pm0.12$. The above evidences indicate that the $B\to\pi K$ puzzle
can be solved. By the fit data, we examine the underlying isospin symmetry of the $B\to\pi K$ system,
the quadrangle relation. The ratio of the two sides of the quadrangle relation is calculated to be
$r=(0.87\pm0.15)\exp(-i22^{\circ})$, which signals the isospin symmetry breaking at $6\sigma$.
The nonzero phases and process-dependent amplitude parameters break the isospin symmetry "dynamically".
