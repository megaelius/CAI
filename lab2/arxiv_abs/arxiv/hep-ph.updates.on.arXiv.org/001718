We develop a framework of coupled transport equations for open heavy flavor and quarkonium states,
in order to describe their transport inside the quark-gluon plasma. Our framework is capable of
studying simultaneously both open and hidden heavy flavor observables in heavy-ion collision
experiments and can account for both, uncorrelated and correlated recombination. Our recombination
implementation depends on real-time open heavy quark and antiquark distributions. We carry out
consistency tests to show how the interplay among open heavy flavor transport, quarkonium dissociation
and recombination drives the system to equilibrium. We then apply our framework to study bottomonium
production in heavy-ion collisions. We include $\Upsilon(1S)$, $\Upsilon(2S)$, $\Upsilon(3S)$,
$\chi_b(1P)$ and $\chi_b(2P)$ in the framework and take feed-down contributions during the hadronic
gas stage into account. Cold nuclear matter effects are included by using nuclear parton distribution
functions for the initial primordial heavy flavor production. A calibrated $2+1$ dimensional
viscous hydrodynamics is used to describe the bulk QCD medium. We calculate both the nuclear modification
factor $R_{\mathrm{AA}}$ of all bottomonia states and the azimuthal angular anisotropy coefficient
$v_2$ of the $\Upsilon(1S)$ state and find that our results agree reasonably with experimental
measurements. Our calculations indicate that correlated cross-talk recombination is an important
production mechanism of bottomonium in current heavy-ion experiments. The importance of correlated
recombination can be tested experimentally by measuring the ratio of $R_{\mathrm{AA}}(\chi_b(1P))$
and $R_{\mathrm{AA}}(\Upsilon(2S))$. 