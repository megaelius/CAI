THOR is the first open-source general circulation model (GCM) developed from scratch to study the
atmospheres and climates of exoplanets, free from Earth- or Solar System-centric tunings. It solves
the general non-hydrostatic Euler equations (instead of the primitive equations) on a sphere using
the icosahedral grid. In the current study, we report major upgrades to THOR, building upon the work
of Mendon\c{c}a et al. (2016). First, while the Horizontally Explicit Vertically Implicit (HEVI)
integration scheme is the same as that described in Mendon\c{c}a et al. (2016), we provide a clearer
description of the scheme and improved its implementation in the code. The differences in implementation
between the hydrostatic shallow (HSS), quasi-hydrostatic deep (QHD) and non-hydrostatic deep
(NHD) treatments are fully detailed. Second, key code improvements are reported including the
elimination of atomic addition and its replacement by reduction addition, as well as ensuring binary
reproducibility. Third, standard physics modules are added: two-stream, double-gray radiative
transfer and dry convective adjustment. Fourth, THOR is tested on additional benchmarks: tidally-locked
Earth, deep hot Jupiter, acoustic wave, and gravity wave. Fifth, we report that differences between
the hydrostatic and non-hydrostatic simulations are negligible in the Earth case, but pronounced
in the hot Jupiter case. Finally, the effects of the so-called "sponge layer", a form of drag implemented
in most GCMs to provide numerical stability, are examined. Overall, these upgrades have improved
the flexibility, user-friendliness, and stability of THOR. 