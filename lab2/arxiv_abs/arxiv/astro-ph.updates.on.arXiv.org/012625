We study how the interaction between the streaming instability and intrinsic gas-phase turbulence
affects planetesimal formation via gravitational collapse. Turbulence impedes the formation
of dense particle clumps by acting as an effective turbulent diffusivity, but it can also promote
planetesimal formation by concentrating solids, for example in zonal flows. We quantify the effect
of turbulent diffusivity using numerical simulations of the streaming instability in small local
domains, forced with velocity perturbations that establish approximately Kolmogorov-like fluid
turbulence. We find that planetesimal formation is strongly suppressed by turbulence once velocity
fluctuations exceed a threshold value of $\delta v^2 \simeq 10^{-3.5} - 10^{-3} c_s^2$. Turbulence
whose strength is just below the threshold reduces the rate of solid material being converted into
bound clumps. The main effect of turbulence is to thicken the mid-plane solid layer. Our results
are thus consistent with planetesimal formation requiring a mid-plane solid-to-gas ratio $\epsilon
\gtrsim 0.5$. We describe a method for tracking bound clumps in our simulations, and use this method
to construct a mass function of planetesimals that is measured for each clump shortly after its collapse.
Adopting this definition of the initial mass, instead of measuring masses at a fixed time, reduces
planetesimal masses by a factor of three. For models in which planetesimals form, we show that the
initial mass function is well-described by a broken power law, whose parameters are robust to the
inclusion and strength of imposed turbulence. Turbulence in protoplanetary disks is likely to
substantially exceed the threshold for planetesimal formation at radii where temperatures $T
\gtrsim 10^3 \ {\rm K}$ lead to thermal ionization. Fully in situ planetesimal and planet formation
may therefore not be viable for the closest-in exoplanets. 