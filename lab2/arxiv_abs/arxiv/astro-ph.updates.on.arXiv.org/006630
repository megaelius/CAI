The photospheres of the coolest helium-atmosphere white dwarfs are characterized by fluid-like
densities. Under those conditions, standard approximations used in model atmosphere codes are
no longer appropriate. Unfortunately, the majority of cool He-rich white dwarfs show no spectral
features, giving us no opportunities to put more elaborate models to the test. In the few cases where
spectral features are observed (such as in cool DQ or DZ stars), current models completely fail to
reproduce the spectroscopic data, signaling shortcomings in our theoretical framework. In order
to fully trust parameters derived solely from the energy distribution, it is thus important to at
least succeed in reproducing the spectra of the few coolest stars exhibiting spectral features,
especially since such stars possess even less extreme physical conditions due to the presence of
heavy elements. In this paper, we revise every building block of our model atmosphere code in order
to eliminate low-density approximations. Our updated white dwarf atmosphere code incorporates
state-of-the-art constitutive physics suitable for the conditions found in cool helium-rich
stars (DC and DZ white dwarfs). This includes new high-density metal line profiles, nonideal continuum
opacities, an accurate equation of state and a detailed description of the ionization equilibrium.
In particular, we present new ab initio calculations to assess the ionization equilibrium of heavy
elements (C, Ca, Fe, Mg and Na) in a dense helium medium and show how our improved models allow us to
achieve better spectral fits for two cool DZ stars, Ross 640 and LP 658-2. 