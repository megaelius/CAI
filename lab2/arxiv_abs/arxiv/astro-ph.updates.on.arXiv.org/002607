Lensing flux-ratio anomalies are most likely caused by gravitational lensing by small-scale dark
matter structures. These anomalies offer the prospect of testing a fundamental prediction of the
cold dark matter (CDM) cosmological model: the existence of numerous substructures that are too
small to host visible galaxies. In two previous studies we found that the number of subhalos in the
six high-resolution simulations of CDM galactic halos of the Aquarius project is not sufficient
to account for the observed frequency of flux ratio anomalies seen in selected quasars from the CLASS
survey. These studies were limited by the small number of halos used, their narrow range of masses
(1-2E12 solar masses) and the small range of lens ellipticities considered. We address these shortcomings
by investigating the lensing properties of a large sample of halos with a wide range of masses in two
sets of high resolution simulations of cosmological volumes and comparing them to a currently best
available sample of radio quasars. We find that, as expected, substructures do not change the flux-ratio
probability distribution of image pairs and triples with large separations, but they have a significant
effect on the distribution at small separations. For such systems, CDM substructures can account
for a substantial fraction of the observed flux-ratio anomalies. For large close-pair separation
systems, the discrepancies existing between the observed flux ratios and predictions from smooth
halo models are attributed to simplifications inherent in these models which do not take account
of fine details in the lens mass distributions. 