We present JEKYLL, a new code for modelling of supernova (SN) spectra and lightcurves based on Monte-Carlo
(MC) techniques for the radiative transfer. The code assumes spherical symmetry, homologous expansion
and steady state for the matter, but is otherwise capable of solving the time-dependent radiative
transfer problem in non-local-thermodynamic-equilibrium (NLTE). The method used was introduced
in a series of papers by Lucy, but the full time-dependent NLTE capabilities of it have never been
tested. Here, we have extended the method to include non-thermal excitation and ionization as well
as charge-transfer and two-photon processes. Based on earlier work, the non-thermal rates are
calculated by solving the Spencer-Fano equation. Using a method previously developed for the SUMO
code, macroscopic mixing of the material is taken into account in a statistical sense. In addition,
a statistical Markov-chain model is used to sample the emission frequency, and we introduce a method
to control the sampling of the radiation field. Except for a description of JEKYLL, we provide comparisons
with the ARTIS, SUMO and CMFGEN codes, which show good agreement in the calculated spectra as well
as the state of the gas. In particular, the comparison with CMFGEN, which is similar in terms of physics
but uses a different technique, shows that the Lucy method does indeed converge in the time-dependent
NLTE case. Finally, as an example of the time-dependent NLTE capabilities of JEKYLL, we present
a model of a Type IIb SN, taken from a set of models presented and discussed in detail in an accompanying
paper. Based on this model we investigate the effects of NLTE, in particular those arising from non-thermal
excitation and ionization, and find strong effects even on the bolometric lightcurve. This highlights
the need for full NLTE calculations when simulating the spectra and lightcurves of SNe. 