Using the GAEA semi-analytic model, we analyse the connection between Damped Lyman-$\alpha$ systems
(DLAs) and HI in galaxies. Our state-of-the-art semi-analytic model is tuned to reproduce the local
galaxy HI mass function, and that also reproduces other important galaxy properties, including
the galaxy mass - gas metallicity relation. To produce catalogs of simulated DLAs we throw $10^5$
random lines of sight in a composite simulated volume: dark matter haloes with log$(\frac{M_{200}}{
M_{\odot}}) \geq 11.5$ are extracted from the Millennium Simulation, while for $9.2 \leq \log(\frac{M_{200}}{
M_{\odot}})<11.5$ we use the Millennium II, and for $8 \leq \log(\frac{M_{200}}{M_{\odot}})
< 9.2$ a halo occupation distribution model. At $2 < z < 3$, where observational data are more accurate,
our fiducial model predicts the correct shape of the column density distribution function, but
its normalization falls short of the observations, with the discrepancy increasing at higher redshift.
The agreement with observations is significantly improved increasing both the HI masses and the
disk radii of model galaxies by a factor 2, as implemented 'a posteriori' in our $2M-2R$ model. In
the redshift range of interest, haloes with $M_{200} \geq {10}^{11} M_{\odot}$ give the major contribution
to $\Omega_{\rm DLA}$, and the typical DLA host halo mass is $\sim {10}^{11} M _{\odot}$. The simulated
DLA metallicity distribution is in relatively good agreement with observations, but our model
predicts an excess of DLAs at low metallicities. Our results suggest possible improvements for
the adopted modelling of the filtering mass and metal ejection in low-mass haloes. 