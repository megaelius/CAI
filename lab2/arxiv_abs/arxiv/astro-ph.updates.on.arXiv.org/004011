We present the deepest study to date of the Lya luminosity function (LF) in a blank field using blind
integral field spectroscopy from MUSE. We constructed a sample of 604 Lya emitters (LAEs) across
the redshift range 2.91 < z < 6.64 using automatic detection software in the Hubble Ultra Deep Field.
We calculate accurate total Lya fluxes capturing low surface brightness extended Lya emission
now known to be a generic property of high-redshift star-forming galaxies. We simulated realistic
extended LAEs to characterise the selection function of our samples, and performed flux-recovery
experiments to test and correct for bias in our determination of total Lya fluxes. We find an accurate
completeness correction accounting for extended emission reveals a very steep faint-end slope
of the LF, alpha, down to luminosities of log10 L erg s^-1< 41.5, applying both the 1/Vmax and maximum
likelihood estimators. Splitting the sample into three broad redshift bins, we see the faint-end
slope increasing from -2.03+1.42-inf at z ~ 3.44 to -2.86+0.76-inf at z ~ 5.48, however no strong
evolution is seen between the 68% confidence regions in L*-alpha parameter space. Using the Lya
line flux as a proxy for star formation activity, and integrating the observed LFs, we find that LAEs'
contribution to the cosmic SFRD rises with redshift until it is comparable to that from continuum-selected
samples by z ~ 6. This implies that LAEs may contribute more to the star-formation activity of the
early Universe than previously thought - any additional interglactic medium correction would
act to further boost the Lya luminosities. Finally, assuming fiducial values for the escape of Lya
and LyC radiation, and the clumpiness of the IGM, we integrated the maximum likelihood LF at 5.00
< z < 6.64 and find we require only a small extrapolation beyond the data (< 1 dex in L) for LAEs alone
to maintain an ionised IGM at z ~ 6. 