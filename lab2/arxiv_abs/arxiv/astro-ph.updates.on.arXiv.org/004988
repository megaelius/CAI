The metallicity of a supernova (SN) progenitor, together with its mass, is one of the main parameters
that rules their outcome. We present a metallicity study of 115 nearby SN host galaxies (0.005<z<0.03)
which hosted 142 SNe using Integral Field Spectroscopy (IFS) from the CALIFA survey. Using O3N2
we found no statistically significant differences between the gas-phase metallicities at the
locations of the three main SN types (Ia, Ib/c and II) all having ~8.50$\pm$0.02 dex. The total galaxy
metallicities are also very similar and we argue that this is because our sample consists only of
SNe discovered in massive galaxies (log(M/Msun)>10 dex) by targeted searches. We also found no
evidence that the metallicity at the SN location differs from the average metallicity at the GCD
of the SNe. By extending our SN sample with published metallicities at the SN location, we studied
the metallicity distributions for all SN subtypes split into SN discovered in targeted and untargeted
searches. We confirm a bias toward higher host masses and metallicities in the targeted searches.
Combining data from targeted and untargeted searches we found a sequence from higher to lower local
metallicity: SN Ia, Ic, and II show the highest metallicity, which is significantly higher than
SN Ib, IIb, and Ic-BL. Our results support the picture of SN Ib resulting from binary progenitors
and, at least part of, SN Ic being the result of single massive stars stripped of their outer layers
by metallicity driven winds. We studied several proxies of the local metallicity frequently used
in the literature and found that the total host metallicity allows for the estimation of the metallicity
at the SN location with an accuracy better than 0.08 dex and very small bias. In addition, weak AGNs
not seen in total spectra may only weakly bias (by 0.04 dex) the metallicity estimate from integrated
spectra. (abridged) 