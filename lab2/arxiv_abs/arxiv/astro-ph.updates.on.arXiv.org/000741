We present a cosmological hydrodynamic simulation of the formation of dwarf galaxies at redshifts
z>~2.5 using a physically-motivated model for H2-regulated star formation. Our simulation,
performed using the Enzo code and reaching a peak resolution of 109 proper parsecs at z=2.5, extends
the results of Kuhlen et al. (2012) to significantly lower redshifts. We show that a star formation
prescription regulated by the local H2 abundance leads to the suppression of star formation in dwarf
galaxy halos with M_h <~ 10^10 Msun and to a large population of gas-rich "dark galaxies" at z=2.5
with low star formation efficiencies and gas depletion timescales >20 Gyr. The fraction of dark
galaxies is 60% at M_h ~ 10^10 Msun and increases rapidly with decreasing halo mass. Dark galaxies
form late and their gaseous disks never reach the surface densities, > ~5700 Msun / pc^2 (Z/10^-3
Zsun)^(-0.88), that are required to build a substantial molecular fraction. Despite this large
population of dark galaxies, we show that our H2-regulated simulation is consistent with both the
observed luminosity function of galaxies and the cosmological mass density of neutral gas at z>~2.5.
Moreover, our results provide a theoretical explanation for the recent detection in fluorescent
Ly-alpha emission of gaseous systems at high redshift with little or no associated star formation.
We further propose that H2-regulation may offer a fresh solution to a number of outstanding "dwarf
galaxy problems" in LambdaCDM. In particular, H2-regulation leads galaxy formation to become
effectively stochastic on mass scales of M_h ~ 10^10 Msun, and thus these massive dwarfs are not "too
big to fail". 