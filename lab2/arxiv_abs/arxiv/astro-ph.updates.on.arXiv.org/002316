We study the acceleration of CR protons and nuclei at GRB internal shocks. Physical quantities and
their time evolution are estimated using the internal shock modeling implemented by Daigne &
Mochkovitch 1998. We consider different hypotheses about the way the energy dissipated at internal
shocks is shared between accelerated CR, e- and B field. We model CR acceleration at mildly relativistic
shocks, including all the significant energy loss processes. We calculate CR and neutrino release
from single GRBs, assuming that nuclei heavier than protons are present in the relativistic wind.
Protons can only reach maximum energies of ~ 10^19.5 eV, while intermediate and heavy nuclei are
able to reach values of ~ 10^20 eV and above. The spectra of nuclei escaping from the acceleration
site are found to be very hard while the combined spectrum of protons and neutrons is much softer.
We calculate the diffuse UHECR flux expected on Earth using the GRB luminosity function from Wanderman
& Piran 2010. Only the models assuming that the prompt emission represent a very small fraction
of the energy dissipated at internal shocks, and that most of this dissipated energy is communicated
to accelerated CR, are able to reproduce the magnitude of the UHECR flux observed. For these models,
the observed shape of the UHECR spectrum can be well reproduced and the evolution of the composition
is compatible with the trend suggested by Auger. We discuss implications of the softer proton component
for the GCR to EGCR transition in the light of the recent composition analyses (KASCADE-Grande experiment).
The associated secondary particle diffuse fluxes do not upset any current observational limit.
Diffuse neutrino flux from GRB sources should however be detected with the lifetime of neutrino
observatories. 