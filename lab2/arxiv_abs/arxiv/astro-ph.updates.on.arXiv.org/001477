We introduce a semi-analytic galaxy formation model implementing a self-consistent treatment
for the hot halo gas configuration and the assembly of central disks. Using the model, we explore
a preventative feedback model, in which the circum-halo medium is assumed to be preheated up to a
certain entropy level by early starbursts or other processes, and compare it with an ejective feedback
model, in which baryons are first accreted into dark matter halos and subsequently ejected out by
feedback. The model demonstrates that when the medium is preheated to an entropy comparable to the
halo virial entropy the baryon accretion can be largely reduced and delayed. In addition, the preheated
medium can establish an extended low density gaseous halo when it accretes into the dark matter halos,
and result in a specific angular momentum of the cooling gas large enough to form central disks as
extended as those observed. Combined with simulated halo assembly histories, the preventative
feedback model can reproduce remarkably well a number of observational scaling relations. These
include the cold baryon (stellar plus cold gas) mass fraction-halo mass relations, star formation
histories, disk size-stellar mass relation and its evolution, and the number density of low-mass
galaxies as a function of redshift. In contrast, the conventional ejective feedback model fails
to reproduce these observational trends. Using the model, we demonstrate that the properties of
disk galaxies are closely tied to the thermal state of hot halo gas and even possibly the circum-halo
medium, which suggests that observational data for the disk properties and circum-galactic hot/warm
medium may jointly provide interesting constraints for galaxy formation models. 