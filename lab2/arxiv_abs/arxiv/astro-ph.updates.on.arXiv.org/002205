We use large hybrid simulations to study ion acceleration and generation of magnetic turbulence
due to the streaming of particles that are self-consistently accelerated at non-relativistic
shocks. When acceleration is efficient, we find that the upstream magnetic field is significantly
amplified. The total amplification factor is larger than 10 for shocks with Alfv\'enic Mach number
$M=100$, and scales with the square root of $M$. The spectral energy density of excited magnetic
turbulence is determined by the energy distribution of accelerated particles, and for moderately-strong
shocks ($M\lesssim30$) agrees well with the prediction of resonant streaming instability, in
the framework of quasilinear theory of diffusive shock acceleration. For $M\gtrsim30$, instead,
Bell's non-resonant hybrid (NRH) instability is predicted and found to grow faster than resonant
instability. NRH modes are excited far upstream by escaping particles, and initially grow without
disrupting the current, their typical wavelengths being much shorter than the current ions' gyroradii.
Then, in the nonlinear stage, most unstable modes migrate to larger and larger wavelengths, eventually
becoming resonant in wavelength with the driving ions, which start diffuse. Ahead of strong shocks
we distinguish two regions, separated by the free-escape boundary: the far upstream, where field
amplification is provided by the current of escaping ions via NRH instability, and the shock precursor,
where energetic particles are effectively magnetized, and field amplification is provided by
the current in diffusing ions. The presented scalings of magnetic field amplification enable the
inclusion of self-consistent microphysics into phenomenological models of ion acceleration
at non-relativistic shocks. 