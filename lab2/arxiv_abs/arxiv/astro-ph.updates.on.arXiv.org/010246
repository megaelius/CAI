Stars formed in clusters can encounter other stars at close distances. In typical open clusters
in the Solar neighbourhood containing hundreds or thousands of member stars, ten to twenty per cent
of Solar-mass member stars are expected to encounter another star at distances closer than 100 au.
These close encounters strongly perturb the planetary systems, directly causing ejection of planets
or their capture by the intruding star, as well as exciting the orbits. Using extensive $N$-body
simulations, we study such fly-by encounters between two Solar System analogues, each with four
giant planets from Jupiter to Neptune. We quantify the rates of loss and capture immediately after
the encounter, e.g., the Neptune analogue is lost in one in four encounters within 100 au, and captured
by the flying-by star in one in twelve encounters. We then perform long-term (up to 1 Gyr) simulations
investigating the ensuing post-encounter evolution. We show that large numbers of planets are
removed from systems due to planet--planet interactions and that captured planets further enhance
the system instability. While encounters can initially leave a planetary system containing more
planets by inserting additional ones, the long-term instability causes a net reduction in planet
number. A captured planet ends up on a retrograde orbit in half of the runs in which it survives for
1 Gyr; also, a planet bound to its original host star but flipped during the encounter may survive.
Thus, encounters between planetary systems are a channel to create counter-rotating planets,
This would happen in around 1% of systems, and such planets are potentially detectable through astrometry
or direct imaging. 