We use two cosmological simulations of structure formation in the standard LCDM scenario to study
the evolutionary histories of dark-matter haloes and to characterize the Lagrangian (protohalo)
regions from which they form. We focus our analysis on haloes identified at redshift z_id=0 and show
that the classic ellipsoidal collapse model developed by Bond & Myers systematically overestimates
their collapse time. If one imposes that halo collapse takes place at z_id, this model requires starting
from a significantly lower linear density contrast than what is measured in the simulations at the
Lagrangian locations of halo formation. Attempting to explain this discrepancy, we test two key
assumptions of the model. First, we show that the tides felt by collapsing haloes due to the surrounding
large-scale structure evolve non-linearly. Although this effect becomes increasingly important
for low-mass haloes that reside in high-density regions, accounting for it in the ellipsoidal collapse
model only marginally improves the agreement with N-body simulations. Second, we track the time
evolution of the physical volume occupied by forming haloes and show that, after turnaround, it
generally stabilizes at a well-defined time, z_c>z_id. Contrary to the basic assumption of
extended Press-Schechter theory based on the excursion-set approach, our results suggest that
most haloes have already assembled their final mass into a coherent structure prior to z_id, and
that the 'collapse redshift', z_c, increases with decreasing halo mass. We discuss the implications
of this result for understanding the origin of the mass-dependence and scatter in the linear threshold
for halo formation. Finally, we show that, when tuned for collapse at z_c, a modified version of the
ellipsoidal collapse model that also accounts for the triaxial nature of protohaloes predicts
their linear density contrast in an unbiased way. 