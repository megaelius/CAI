The inference of the underlying state of the plasma in the solar chromosphere remains extremely
challenging because of the non-local character of the observed radiation and of the plasma conditions
in this layer. Inversion methods allow deriving a model atmosphere that can reproduce the observed
spectra by undertaking several physical assumptions. The most advanced approaches involve a depth-stratified
model atmosphere described by temperature, line-of-sight velocity, turbulent velocity, the
three components of the magnetic field vector, and gas and electron pressure. The parameters of
the radiative transfer equation are computed from a solid ground of physical principles. In order
to apply these techniques to spectral lines that sample the chromosphere, non-local thermodynamical
equilibrium effects must be included in the calculations. We have developed a new inversion code
STiC to study spectral lines that sample the upper chromosphere. The code is based on the RH forward
synthesis code that we have modified to make the inversions faster and more stable. For the first
time, STiC allows processing lines from multiple atoms in non-LTE, also including partial redistribution
effects (PRD). Furthermore, we include a regularization strategy that enables having model atmospheres
with a complex depth stratification, without introducing artifacts in the reconstructed physical
parameters, which usually manifest in the form of oscillatory behavior. This approach takes steps
towards a node-less inversion, where the value of the physical parameters at each grid point is a
free parameter. In this paper we discuss the implementation of the aforementioned techniques,
the description of the model atmosphere and the optimizations that we have applied to the code. We
carry out some numerical experiments to show the performance of the code and of the regularization
techniques that we have implemented. 