Nanophotonics provides the ability to rapidly and precisely reconfigure light beams on a compact
platform. Infrared nanophotonic devices are widely used in data communications to overcome traditional
bandwidth limitations of electrical interconnects. Nanophotonic devices also hold promise for
use in biological applications that require visible light, but this has remained technically elusive
due to the challenges of reconfiguring and guiding light at these smaller dimensions. In neuroscience,
for example, there is a need for implantable optical devices to optogenetically stimulate neurons
across deep brain regions with the speed and precision matching state-of-the-art recording probes.
Here we demonstrate the first platform for reconfigurable nanophotonic devices in the visible
wavelength range and show its application in vivo in the brain. We demonstrate an implantable probe
endowed with the ability to rapidly switch and route multiple optical beams using a nanoscale switching
network. Each switch consists of a silicon nitride waveguide structure that can be reconfigured
by electrically tuning the phase of light and is designed for robustness to fabrication variation,
enabling scalable devices. By implanting our probe in mouse visual cortex, we demonstrate in vivo
the ability to stimulate identified sets of neurons across layers to produce multi-neuron spike
patterns and record them simultaneously with sub-millisecond temporal precision. This nanophotonic
platform can be scaled up and integrated with high-density neural recording technologies, opening
the door to implantable probe technologies that are able to simultaneously record and stimulate
the activity of large neural populations at distant regions of the brain with sub-millisecond precision.
We expect this platform will enable researchers to gain a deeper understanding into the spatio-temporal
precision of the neural code. 