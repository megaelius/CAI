We investigate the reconstruction of a turbulent flow field in the atmospheric boundary layer from
a time series of lidar measurements, using Large-Eddy Simulations (LES) and a 4D-Var data assimilation
algorithm. This leads to an optimisation problem in which the error between measurements and simulations
is minimised over an observation time horizon. To exploit the spatial coherence of the turbulence,
we use a quadratic regularisation in the objective function, that is based on the two-point covariance
matrix. Moreover, to improve conditioning, and remove continuity constraints, the problem is
transformed into a Karhunen-Lo\`eve basis. For the optimisation, we use a quasi-Newton limited-memory
BFGS algorithm combined with an adjoint approach for the gradient. We also consider reconstruction
based on a Taylor's frozen turbulence (TFT) model as point of comparison. To evaluate the approach,
we construct a series of virtual lidar measurements from a fine-grid LES of a pressure-driven boundary-layer.
The reconstruction uses LES on a coarser mesh and smaller domain, and results are compared to the
fine-grid reference. Two lidar scanning modes are considered: a classical plan-position-indicator
mode, which swipes the lidar beam in a horizontal plane, and a 3D pattern that is based on a Lissajous
curve. We find that normalised errors lie between 15% and 25% (error variance normalised by background
variance) in the scanning region, and increase to $100\%$ over a distance that is comparable to the
correlation length scale outside this scanning region. Moreover, LES outperforms TFT by 30% to
70% depending on scanning mode and location. 