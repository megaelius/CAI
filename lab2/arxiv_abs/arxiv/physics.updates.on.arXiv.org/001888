The flying ice cube effect is a molecular dynamics simulation artifact in which the use of velocity
rescaling thermostats sometimes causes the violation of the equipartition theorem, affecting
both structural and dynamic properties. The reason for this artifact and the conditions under which
it occurs have not been fully understood. Since the flying ice cube effect was first demonstrated,
a new velocity rescaling algorithm (the CSVR thermostat) has been developed and become popular
without its effects on the equipartition theorem being truly known. Meanwhile, use of the simple
velocity rescaling and Berendsen thermostat algorithms has not abated but has actually continued
to grow. Here, we have calculated the partitioning of the kinetic energy between translational,
rotational, and vibrational modes in simulations of diatomic molecules to explicitly determine
whether the equipartition theorem is violated under different thermostats and while rescaling
velocities to different kinetic energy distributions. We have found that the underlying cause
of the flying ice cube effect is a violation of balance leading to systematic redistributions of
kinetic energy under simple velocity rescaling and the Berendsen thermostat. When velocities
are instead rescaled to the canonical ensemble's kinetic energy distribution, as is done with the
CSVR thermostat, the equipartition theorem is not violated, and we show that the CSVR thermostat
satisfies detailed balance. The critical necessity for molecular dynamics practitioners to abandon
the use of popular yet incorrect velocity rescaling algorithms is underscored with an example demonstrating
that the main result of a highly-cited study is entirely due to artifacts resulting from the study's
use of the Berendsen thermostat. 