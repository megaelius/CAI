To study axonal microstructure with diffusion MRI, axons are typically modeled as straight impermeable
cylinders, whereby the transverse diffusion MRI signal can be made sensitive to the cylinder's
inner diameter. However, the shape of a real axon varies along the axon direction, which couples
the longitudinal and transverse diffusion of the overall axon direction. Here we develop a theory
of the intra-axonal diffusion MRI signal based on coarse-graining of the axonal shape by 3d diffusion.
We demonstrate how the estimate of the inner diameter is confounded by the diameter variations (beading),
and by the local variations in direction (undulations) along the axon. We analytically relate diffusion
MRI metrics, such as time-dependent radial diffusivity D(t) and kurtosis K(t), to the axonal shape,
and validate our theory using Monte Carlo simulations in synthetic undulating axons with randomly
positioned beads, and in realistic axons reconstructed from electron microscopy images of mouse
brain white matter. We show that (i) In the narrow pulse limit, the inner diameter from D(t) is overestimated
by about twofold due to a combination of axon caliber variations and undulations (each contributing
a comparable effect size); (ii) The narrow-pulse kurtosis K$_{t\to\infty}$ deviates from that
in an ideal cylinder due to caliber variations; we also numerically calculate the fourth-order
cumulant for an ideal cylinder in the wide pulse limit, which is relevant for inner diameter overestimation;
(iii) In the wide pulse limit, the axon diameter overestimation is mainly due to undulations at low
diffusion weightings b; and (iv) The effect of undulations can be considerably reduced by directional
averaging of high-b signals, with the apparent inner diameter given by a combination of the axon
caliber (dominated by the thickest axons), caliber variations, and the residual contribution
of undulations. 