We present efficient methods for computing wave scattering by diffraction gratings that exhibit
two-dimensional periodicity in three dimensional (3D) space. Applications include scattering
in acoustics, electromagnetics and elasticity. Our approach uses boundary-integral equations.
The quasi-periodic Green function is a doubly infinite sum of scaled 3D free-space outgoing Helmholtz
Green functions. Their source points are located at the nodes of a periodicity lattice of the grating.
For efficient numerical computation of the lattice sum, we employ a smooth truncation. Super-algebraic
convergence to the Green function is achieved as the truncation radius increases, except at frequency-wavenumber
pairs at which a Rayleigh wave is at exactly grazing incidence to the grating. At these "Wood frequencies",
the term in the Fourier series representation of the Green function that corresponds to the grazing
Rayleigh wave acquires an infinite coefficient and the lattice sum blows up. At Wood frequencies,
we modify the Green function by adding two types of terms to it. The first type adds weighted spatial
shifts of the Green function to itself with singularities below the grating; this yields algebraic
convergence. The second-type terms are quasi-periodic plane wave solutions of the Helmholtz equation.
They reinstate (with controlled coefficients) the grazing modes, effectively eliminated by the
terms of first type. These modes are needed in the Green function for guaranteeing the well-posedness
of the boundary-integral equation that yields the scattered field. We apply this approach to acoustic
scattering by a doubly periodic 2D grating near and at Wood frequencies and scattering by a doubly
periodic array of scatterers away from Wood frequencies. 