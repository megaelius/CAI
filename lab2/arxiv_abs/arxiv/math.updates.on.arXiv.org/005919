In this paper, we consider a joint sampling and transmission scheduling problem for optimizing
data freshness in a multi-source system, where the sources take turns to generate update packets,
and forward them to their destinations one-by-one through a shared channel with random delay. The
freshness of the received packets is measured by a non-decreasing penalty function of the age of
information, where the same age-penalty function is used for all sources. The decision maker consists
of two components: A scheduler that chooses the update order of the sources, and a sampler that determines
when a source should generate a new packet in its turn. Our goal is to find the optimal scheduler-sampler
pairs that minimize the total-average peak age-penalty (Ta-PAP) and the total-average age-penalty
(Ta-AP). We prove that the Maximum Age First (MAF) scheduler and the zero-wait sampler, in which
a new packet is generated once the channel becomes idle, are jointly optimal for minimizing the Ta-PAP.
Meanwhile, the MAF scheduler and a relative value iteration with reduced complexity (RVI-RC) sampler
are jointly optimal for minimizing the Ta-AP. The RVI-RC sampler is based on a relative value iteration
(RVI) algorithm whose complexity is reduced by exploiting a threshold property in the optimal sampler.
Finally, a low-complexity threshold-type sampler is devised via an approximate analysis of Bellman's
equation. In the special case of a linear age-penalty function, this threshold-type sampler reduces
to a simple water-filling sampler. The MAF scheduler and threshold-type sampler are very close
to the optimum for minimizing the Ta-AP in our numerical evaluations. 