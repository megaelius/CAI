The increasing penetration of inertialess new renewable energy sources reduces the overall mechanical
inertia available in power grids and accordingly raises a number of issues of grid stability over
short to medium time scales. It has been suggested that this reduction of overall inertia can be compensated
to some extent by the deployment of substitution inertia - synthetic inertia, flywheels or synchronous
condensers. Of particular importance is to optimize the placement of the limited available substitution
inertia, to mitigate voltage angle and frequency disturbances following a fault such as an abrupt
power loss. Performance measures in the form of H2-norms have been recently introduced to evaluate
the overall magnitude of such disturbances on an electric power grid. However, despite the mathematical
conveniance of these measures, analytical results can be obtained only under rather restrictive
assumptions of uniform damping ratio, or homogeneous distribution of inertia and/or primary control
in the system. Here, we introduce matrix perturbation theory to obtain analytical results for optimal
inertia and primary control placement where both are heterogeneous. Armed with that efficient
tool, we construct two simple algorithms that independently determine the optimal geographical
distribution of inertia and primary control. These algorithms are then implemented on a model of
the synchronous transmission grid of continental Europe. We find that the optimal distribution
of inertia is geographically homogeneous but that primary control should be mainly located on the
slow modes of the network, where the intrinsic grid dynamics takes more time to damp frequency disturbances.
