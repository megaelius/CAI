We provide a detailed analysis of the classical and quantized theory of a multiplet of inhomogeneous
Klein-Gordon fields, which couple to the spacetime metric and also to an external source term; thus
the solutions form an affine space. Following the formulation of affine field theories in terms
of presymplectic vector spaces as proposed in [Annales Henri Poincare 15, 171 (2014)], we determine
the relative Cauchy evolution induced by metric as well as source term perturbations and compute
the automorphism group of natural isomorphisms of the presymplectic vector space functor. Two
pathological features of this formulation are revealed: the automorphism group contains elements
that cannot be interpreted as global gauge transformations of the theory; moreover, the presymplectic
formulation does not respect a natural requirement on composition of subsystems. We therefore
propose a systematic strategy to improve the original description of affine field theories at the
classical and quantized level, first passing to a Poisson algebra description in the classical
case. The idea is to consider state spaces on the classical and quantum algebras suggested by the
physics of the theory (in the classical case, we use the affine solution space). The state spaces
are not separating for the algebras, indicating a redundancy in the description. Removing this
redundancy by a quotient, a functorial theory is obtained that is free of the above mentioned pathologies.
These techniques are applicable to general affine field theories and Abelian gauge theories. The
resulting quantized theory is shown to be dynamically local. 