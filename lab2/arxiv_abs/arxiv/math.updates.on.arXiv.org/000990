Considering the structure of grid-forming/feeding modules in dc microgrid (MG), the hierarchical
Plug-and-Play voltage/current controller of dc MG is proposed. Different from existing methods,
the main contributions are provided as follows: 1) A PnP controller for the current-controlled
distributed generation units (CDGUs) is proposed to achieve grid-feeding current tracking while
guaranteeing the stability of the whole system. Moreover, the set of stabilizing controllers for
CDGUs is characterized explicitly in terms of simple inequalities on the control coefficients.
2) A distributed generation module (DGM) consisting of CDGU and voltage-controlled DGUs (VDGU)
is considered, in which the CDGU is used for renewable energy sources (RES) to feed current and VDGU
is used for energy storage system (ESS) to provide voltage support. A PnP voltage/current controller
is proposed to achieve simultaneous grid-forming/feeding function irrespective of the power
line parameters. Also in this case, the stabilizing controller is related only to local parameters
of a DGM and is characterized by explicit inequalities. 3) For the system with interconnection of
DGMs, a leader-based voltage/current distributed secondary controller is proposed to achieve
both the voltage and current regulation without specifying the individual setpoints for each DGMs.
By approximating the primary PnP controller with unitary gains, the model of leader-based secondary
controller with the PI interface is established and the stability of the closed-loop MG is proven
by Lyapunov theory. With the proposed controller, CDGUs and DGMs can plug-in/out of the MG seamlessly
without knowing any information of the MG system and without changing control coefficients for
other units.Finally, theoretical results are demonstrated by hardware-in-loop simulation tests.
