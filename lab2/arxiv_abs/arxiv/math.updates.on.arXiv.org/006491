We study amenability of definable groups and topological groups, and prove various results, briefly
described below. Among our main technical tools, of interest in its own right, is an elaboration
on and strengthening of the Massicot-Wagner version of the stabilizer theorem, and also some results
about measures and measure-like functions (which we call means and pre-means). As an application
we show that if $G$ is an amenable topological group, then the Bohr compactification of $G$ coincides
with a certain "weak Bohr compactification" introduced in [19]. In other words, the conclusion
says that certain connected components of $G$ coincide: $G^{00}_{top} = G^{000}_{top}$. We also
prove wide generalizations of this result, implying in particular its extension to a "definable-topological"
context, confirming the main conjectures from [19]. We also introduce $\bigvee$-definable group
topologies on a given $\emptyset$-definable group $G$ (including group topologies induced by
type-definable subgroups as well as uniformly definable group topologies), and prove that the
existence of a mean on the lattice of closed, type-definable subsets of $G$ implies (under some assumption)
that $cl(G^{00}_M) = cl(G^{000}_M)$ for any model $M$. Secondly, we study the relationship between
(separate) definability of an action of a definable group on a compact space (in the sense of [11]),
weakly almost periodic (wap) actions of $G$ (in the sense of [9]), and stability. We conclude that
any group $G$ definable in a sufficiently saturated structure is "weakly definably amenable" in
the sense of [19], namely any definable action of $G$ on a compact space supports a $G$-invariant
probability measure. This gives negative solutions to some questions and conjectures raised in
[17] and [19]. Stability in continuous logic will play a role in some proofs in this part of the paper.
