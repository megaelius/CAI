We calculate the generating functions of BPS indices using their modular properties in Type II and
M-theory compactifications on compact genus one fibered CY 3-folds with singular fibers and additional
rational sections or just $N$-sections, in order to study string dualities in four and five dimensions
as well as rigid limits in which gravity decouples. The generating functions are Jacobi-forms of
$\Gamma_1(N)$ with the complexified fiber volume as modular parameter. The string coupling $\lambda$,
or the $\epsilon_\pm$ parameters in the rigid limit, as well as the masses of charged hypermultiplets
and non-Abelian gauge bosons are elliptic parameters. To understand this structure, we show that
specific auto-equivalences act on the category of topological B-branes on these geometries and
generate an action of $\Gamma_1(N)$ on the stringy K\"ahler moduli space. We argue that these actions
can always be expressed in terms of the generic Seidel-Thomas twist with respect to the 6-brane together
with shifts of the B-field and are thus monodromies. This implies the elliptic transformation law
that is satisfied by the generating functions. We use Higgs transitions in F-theory to extend the
ansatz for the modular bootstrap to genus one fibrations with $N$-sections and boundary conditions
fix the all genus generating functions for small base degrees completely. This allows us to study
in depth a wide range of new, non-perturbative theories, which are Type II theory duals to the CHL
$\mathbb{Z}_N$ orbifolds of the heterotic string on $K3\times T_2$. In particular, we compare
the BPS degeneracies in the large base limit to the perturbative heterotic one-loop amplitude with
$R_+^2 F_+^{2g-2}$ insertions for many new Type II geometries. In the rigid limit we can refine the
ansatz and obtain the elliptic genus of superconformal theories in 5d. 