We consider a single server system with infinite waiting room in a random environment. The service
system and the environment interact in both directions. Whenever the environment enters a prespecified
subset of its state space the service process is completely blocked: Service is interrupted and
newly arriving customers are lost. We prove an if-and-only-if-condition for a product form steady
state distribution of the joint queueing-environment process. A consequence is a strong insensitivity
property for such systems. We discuss several applications, e.g. from inventory theory and reliability
theory, and show that our result extends and generalizes several theorems found in the literature,
e.g. of queueing-inventory processes. We investigate further classical loss systems, where due
to finite waiting room loss of customers occurs. In connection with loss of customers due to blocking
by the environment and service interruptions new phenomena arise. We further investigate the embedded
Markov chains at departure epochs and show that the behaviour of the embedded Markov chain is often
considerably different from that of the continuous time Markov process. This is different from
the behaviour of the standard M/G/1, where the steady state of the embedded Markov chain and the continuous
time process coincide. For exponential queueing systems we show that there is a product form equilibrium
of the embedded Markov chain under rather general conditions. For systems with non-exponential
service times more restrictive constraints are needed, which we prove by a counter example where
the environment represents an inventory attached to an M/D/1 queue. Such integrated queueing-inventory
systems are dealt with in the literature previously, and are revisited here in detail. 