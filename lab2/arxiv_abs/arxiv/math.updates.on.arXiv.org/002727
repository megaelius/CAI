The increasing diffusion of distributed energy generation systems requires the development of
new control paradigms for the coordination of micro-generators, storage systems, and loads aimed
at maintaining the efficiency and the safe operability of the electricity network. MicroGrids
(MGs) are an interesting way to locally manage groups of generation devices, but they cannot singularly
provide a significant contribution to sustain the main electricity grid in terms of ancillary services,
such as the availability of a minimum amount of power reserve for the frequency regulation. For these
reasons, in this paper we propose a framework for the aggregation and coordination of interconnected
MGs to provide ancillary services to the main utility. The proposed framework is structured in three
main phases. In the first one, a distributed optimization algorithm computes the day-ahead profile
of the active power production of the MGs based on the available forecasts of the renewable sources
production and the loads absorption. In this phase, scalability of the optimization problem and
confidentiality requirements are guaranteed. In the second phase, reactive power flows are scheduled
and it is ensured that the active power trends planned in the first phase do not compromise the voltage/current
limitations. A final third phase is used to schedule the active and reactive power profiles of the
generation units of each MG to make them consistent with the requirements and results of the previous
two phases. The developed method is used for control of the IEEE 13-bus system network and the results
achieved are thoroughly discussed in terms of performance and scalability properties. 