Home retrofitting provides a means to improve the basic energy and comfort characteristics of a
building stock, which cannot be renewed because of prohibitive costs. We analyze how model predictive
control (MPC) applied to indoor microclimate control can provide energy-efficient solutions
to the problem of occupants' comfort in a variety of situations principally imposed by external
weather and room occupancy. For this purpose we define an objective function for the energy consumption,
and we consider two illustrative cases: one building designed and built in recent times with modern
HVAC equipment, and one designed and built several decades ago with poor thermal characteristics
and no dedicated ventilation system. Our model includes various physical effects such as air infiltration
and indoor thermal "inertia mass" (inner walls, floor, ceiling, and furniture), and also accounts
for the impact of human presence essentially as heat and CO$_2$ sources. The influence on the numerical
results of forecast horizons and of uncertainties due to inaccuracies in the weather and room occupancy
forecasts, are analyzed. As we solve non-convex optimization problems using a linear and a nonlinear
optimizer, full MPC performance is compared to both linearized MPC and a standard on/off controller.
The main advantage of MPC is its ability to provide satisfactory solutions for microclimate control
at the least possible energy cost for both modern and old buildings. As old buildings are usually
not properly ventilated, we see in light of our simulation results, that a supply ventilation system
installation provides a solution for significant air quality improvement. 