A family $F$ of sets is said to be $t$-intersecting if $|A \cap B| \geq t$ for any $A,B \in F$. The seminal
Complete Intersection Theorem of Ahlswede and Khachatrian (1997) gives the maximal size $f(n,k,t)$
of a $t$-intersecting family of $k$-element subsets of $[n]=\{1,2,\ldots,n\}$, together with
a characterisation of the extremal families. The forbidden intersection problem, posed by Erd\H{o}s
and S\'{o}s in 1971, asks for a determination of the maximal size $g(n,k,t)$ of a family $F$ of $k$-element
subsets of $[n]$ such that $|A \cap B| \neq t-1$ for any $A,B \in F$. In this paper, we show that for any
fixed $t \in \mathbb{N}$, if $o(n) \leq k \leq n/2-o(n)$, then $g(n,k,t)=f(n,k,t)$. In combination
with prior results, this solves the above problem of Erd\H{o}s and S\'{o}s for any constant $t$,
except for in the ranges $n/2-o(n) < k < n/2+t/2$ and $k < 2t$. One key ingredient of the proof is the
following sharp `stability' result for the Complete Intersection Theorem: if $k/n$ is bounded
away from $0$ and $1/2$, and $F$ is a $t$-intersecting family of $k$-element subsets of $[n]$ such
that $|F| \geq f(n,k,t) - O(\binom{n-d}{k})$, then there exists a family $G$ such that $G$ is extremal
for the Complete Intersection Theorem, and $|F \setminus G| = O(\binom{n-d}{k-d})$. We believe
this result to be of interest in its own right; indeed, it proves a conjecture of Friedgut from 2008.
We prove it by combining classical `shifting' arguments with a `bootstrapping' method based upon
an isoperimetric inequality. Another key ingredient is a `weak regularity lemma' for families
of $k$-element subsets of $[n]$, where $k/n$ is bounded away from 0 and 1. This states that any such
family $F$ is approximately contained within a `junta', such that the restriction of $F$ to each
subcube determined by the junta is `pseudorandom' in a certain sense. 