Let $\mathcal{S}$ be a nonempty semigroup endowed with a binary associative operation $*$. An element
$e$ of $\mathcal{S}$ is said to be idempotent if $e*e=e$. Originated by one question of P. Erd\H{o}s
to D.A. Burgess: {\sl `If $\mathcal{S}$ is a finite semigroup of order $n$, does any $\mathcal{S}$-valued
sequence $T$ of length $n$ contain a nonempty subsequence the product of whose terms, in some order,
is idempotent?'}, we make a study of the associated invariant, denoted ${\rm I}(\mathcal{S})$
and called Erd\H{o}s-Burgess constant which is the smallest positive integer $\ell$ such that
any $\mathcal{S}$-valued sequence $T$ of length $\ell$ contain a nonempty subsequence the product
of whose terms, in some order, is an idempotent. Let $\mathcal{S}_R$ be the multiplicative semigroup
of any commutative unitary ring $R$. We prove that ${\rm I}(\mathcal{S}_R)$ is finite if and only
if $R$ is finite, provided that the quotient ring $R/J(R)$ of $R$ modulo its Jacobson radical $J(R)$
is not a direct product of an infinite Boolean unitary ring and finitely many finite fields. As a corollary,
if $R$ is Noetherian, then ${\rm I}(\mathcal{S}_R)$ is finite if and only if $R$ is finite. We also
make a study of ${\rm I}(\mathcal{S})$ when $\mathcal{S}$ is a direct product of arbitrarily many
of cyclic semigroups. We give the necessary and sufficient conditions such that ${\rm I}(\mathcal{S})$
is finite, and in particular, we obtain sharp bounds of ${\rm I}(\mathcal{S})$ in case ${\rm I}(\mathcal{S})$
is finite, and determine the precise values of ${\rm I}(\mathcal{S})$ in some cases. In addition,
the structure of long sequences containing no nonempty subsequence whose product is idempotent
in some order is characterized when $\mathcal{S}$ is a finite cyclic semigroup. 