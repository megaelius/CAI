In this paper we provide a computationally tractable procedure for designing affine policies for
a constrained robust multistage decision problem as it pertains to linear regime-switching models.
Performance specifications are expressed via several quadratic constraints, while the dynamic
model is affected by external disturbances and an unknown initial state. Our two main contributions
in regards to the existing literature are the investigation of the wider class of regime-switching
models and the efficient handling of quadratic constraints via semidefinite programming. Prior
work had focused on linear dynamic models exhibiting deterministic evolution subject to linear
constraints on the finite horizon state-control trajectory. Bringing regime switching within
the scope of robust optimization allows one to investigate dynamic models that may exhibit different
modes of operation, as well as parametric uncertainty. Accounting for quadratic constraints enables
one to robustly confine the deviation of state and control variables from desired values on the finite
time horizon under consideration. We derive our results under the general assumptions of Markovian
regime switching and provided that the initial state and external disturbances lie in an uncertainty
set expressed as the intersection of ellipsoids centered at the origin. Our methodology is based
on expanding the notion of affine policies that are functions of the so called "purified outputs",
to the class of linear regime-switching models. This re-parametrization of the set of policies
induces a bi-affine structure in the state and control variables. Subsequent use of the approximate
inhomogeneous S-lemma reduces the policy design problem to an explicit convex program, thus facilitating
computational tractability. We illustrate our approach by exploring a classical example of multi-period
portfolio optimization. 