As a new tool in the NextGen portfolio, the Collaborative Trajectory Options Programs (CTOP) combines
multiple features from its forerunners including Ground Delay Program (GDP), Airspace Flow Program
(AFP) and reroutes, and can manage multiple Flow Constrained Areas (FCAs) with a single program.
A key research question in CTOP is how to set traffic flow rates under traffic demand and airspace
capacity uncertainties. In this paper, we first investigate existing CTOP related stochastic
optimization models and point out their roles in CTOP flow rate planning, and their advantages and
disadvantages in terms of model flexibility, performance, practicality and Collaborative Decision
Making (CDM) software compatibility, etc. CTOP FCA rate planning problem has been split into two
steps: traffic flow rate optimization given demand estimation, and flow rate adaptation when flight
rerouting is considered. Second, we discuss in detail a class of models called FCA-PCA (Potentially
Constrained Area) models, which are extended from GDP models to solve the first step of the problem,
and were considered promising as they are designed to be consistent with current CTOP software implementation.
We will reveal one inherent shortcoming suffered by FCA-PCA models and show that how this deficiency
can be addressed by the PCA model family. We will talk about the problems that prevent stochastic
programming being optimal in the second step of the problem. Third, we discuss the applicability
of simulation-based optimization, combine it with stochastic programming based heuristics and
test the resulting new model on a realistic use case. The results are very encouraging. The models
and discussions in this work are not only useful in more effectively implementing and analyzing
CTOP programs, but are also valuable for the design of future air traffic flow program. 