This paper considers an unmanned aerial vehicle (UAV)-enabled wireless sensor network (WSN) in
urban areas, where a UAV is deployed to collect data from distributed sensor nodes (SNs) within a
given duration. To characterize the occasional building blockage between the UAV and SNs, we construct
the probabilistic line-of-sight (LoS) channel model for a Manhattan-type city by using the combined
simulation and data regression method, which is shown in the form of a generalized logistic function
of the UAV-SN elevation angle. We assume that only the knowledge of SNs' locations and the probabilistic
LoS channel model is known a priori, while the UAV can obtain the instantaneous LoS/Non-LoS channel
state information (CSI) with the SNs in real time along its flight. Our objective is to maximize the
minimum (average) data collection rate from all the SNs for the UAV. To this end, we formulate a new
rate maximization problem by jointly optimizing the UAV three-dimensional (3D) trajectory and
transmission scheduling of SNs. Although the optimal solution is intractable due to the lack of
the complete UAV-SNs CSI, we propose in this paper a novel and general design method, called hybrid
offline-online optimization, to obtain a suboptimal solution to it, by leveraging both the statistical
and real-time CSI. Essentially, our proposed method decouples the joint design of UAV trajectory
and communication scheduling into two phases: namely, an offline phase that determines the UAV
path prior to its flight based on the probabilistic LoS channel model, followed by an online phase
that adaptively adjusts the UAV flying speeds along the offline optimized path as well as communication
scheduling based on the instantaneous UAV-SNs CSI and SNs' individual amounts of data received
accumulatively. 