We study a priori estimates for a class of non-negative local weak solution to the weighted fast diffusion
equation $u_t = |x|^{\gamma} \nabla\cdot (|x|^{-\beta} \nabla u^m)$, with $0 < m <1$ posed on cylinders
of $(0,T)\times{\mathbb R}^N$. The weights $|x|^{\gamma}$ and $|x|^{-\beta}$, with $\gamma
< N$ and $\gamma -2 < \beta \leq \gamma(N-2)/N$ can be both degenerate and singular and need not belong
to the class $\mathcal{A}_2$, a typical assumption for this kind of problems. This range of parameters
is optimal for the validity of a class of Caffarelli-Kohn-Nirenberg inequalities, which play the
role of the standard Sobolev inequalities in this more complicated weighted setting. The weights
that we consider are not translation invariant and this causes a number of extra difficulties and
a variety of scenarios: for instance, the scaling properties of the equation change when considering
the problem around the origin or far from it. We therefore prove quantitative - with computable constants
- upper and lower estimates for local weak solutions, focussing our attention where a change of geometry
appears. Such estimates fairly combine into forms of Harnack inequalities of forward, backward
and elliptic type. As a consequence, we obtain H\"older continuity of the solutions, with a quantitative
(even if non-optimal) exponent. Our results apply to a quite large variety of solutions and problems.
The proof of the positivity estimates requires a new method and represents the main technical novelty
of this paper. Our techniques are flexible and can be adapted to more general settings, for instance
to a wider class of weights or to similar problems posed on Riemannian manifolds, possibly with unbounded
curvature. In the linear case, $m=1$, we also prove quantitative estimates, recovering known results
in some cases and extending such results to a wider class of weights. 